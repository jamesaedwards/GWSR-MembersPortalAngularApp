{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/shared/tarrif.service\";\nimport * as i2 from \"../renew.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"../security-lookup/security-lookup.component\";\nimport * as i5 from \"../../shared/tarrifs-list/tarrifs-list.component\";\nimport * as i6 from \"../../shared/payment-methods-table/payment-methods-table.component\";\nimport * as i7 from \"../../shared/membership-declarations/membership-declarations.component\";\nimport * as i8 from \"../../shared/please-waitpopup/please-waitpopup.component\";\n\nfunction RenewhomeComponent_app_security_lookup_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-security-lookup\", 3);\n    i0.ɵɵlistener(\"showLoading\", function RenewhomeComponent_app_security_lookup_4_Template_app_security_lookup_showLoading_0_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.loading = true;\n    })(\"stopLoading\", function RenewhomeComponent_app_security_lookup_4_Template_app_security_lookup_stopLoading_0_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.loading = false;\n    })(\"onRenewalStarted\", function RenewhomeComponent_app_security_lookup_4_Template_app_security_lookup_onRenewalStarted_0_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.renewalData = $event;\n    });\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction RenewhomeComponent_div_5_app_tarrifs_list_22_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-tarrifs-list\", 10);\n    i0.ɵɵlistener(\"onTarrifSelect\", function RenewhomeComponent_div_5_app_tarrifs_list_22_Template_app_tarrifs_list_onTarrifSelect_0_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext(2);\n      return ctx_r12.tarrifSelectedId = 1;\n    });\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction RenewhomeComponent_div_5_p_23_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"p\")(1, \"strong\");\n    i0.ɵɵtext(2, \"Selected Membership: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3);\n    i0.ɵɵelementStart(4, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function RenewhomeComponent_div_5_p_23_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext(2);\n      return ctx_r14.tarrifSelectedId = 0;\n    });\n    i0.ɵɵtext(5, \"Change\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r8.getSelectedTarrifDescription(), \" \");\n  }\n}\n\nfunction RenewhomeComponent_div_5_app_payment_methods_table_24_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-payment-methods-table\", 12);\n    i0.ɵɵlistener(\"onMethodSelected\", function RenewhomeComponent_div_5_app_payment_methods_table_24_Template_app_payment_methods_table_onMethodSelected_0_listener($event) {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r16 = i0.ɵɵnextContext(2);\n      return ctx_r16.selectedPaymentMethod = $event;\n    });\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction RenewhomeComponent_div_5_app_membership_declarations_25_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r19 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-membership-declarations\", 13);\n    i0.ɵɵlistener(\"declarationsChange\", function RenewhomeComponent_div_5_app_membership_declarations_25_Template_app_membership_declarations_declarationsChange_0_listener($event) {\n      i0.ɵɵrestoreView(_r19);\n      const ctx_r18 = i0.ɵɵnextContext(2);\n      return ctx_r18.declarations = $event;\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"declarations\", ctx_r10.declarations);\n  }\n}\n\nfunction RenewhomeComponent_div_5_button_26_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r21 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function RenewhomeComponent_div_5_button_26_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r21);\n      const ctx_r20 = i0.ɵɵnextContext(2);\n      return ctx_r20.sendRenewal();\n    });\n    i0.ɵɵtext(1, \"Pay and Renew\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction RenewhomeComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 4)(2, \"h2\", 5);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\")(5, \"strong\");\n    i0.ɵɵtext(6, \"Your Name: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7);\n    i0.ɵɵelement(8, \"br\");\n    i0.ɵɵelementStart(9, \"strong\");\n    i0.ɵɵtext(10, \"Email Address: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11);\n    i0.ɵɵelement(12, \"br\");\n    i0.ɵɵelementStart(13, \"strong\");\n    i0.ɵɵtext(14, \"Current Membership: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(15);\n    i0.ɵɵelement(16, \"br\");\n    i0.ɵɵelementStart(17, \"strong\");\n    i0.ɵɵtext(18, \"Expiry Date: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(19);\n    i0.ɵɵpipe(20, \"date\");\n    i0.ɵɵelement(21, \"br\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(22, RenewhomeComponent_div_5_app_tarrifs_list_22_Template, 1, 0, \"app-tarrifs-list\", 6);\n    i0.ɵɵtemplate(23, RenewhomeComponent_div_5_p_23_Template, 6, 1, \"p\", 2);\n    i0.ɵɵtemplate(24, RenewhomeComponent_div_5_app_payment_methods_table_24_Template, 1, 0, \"app-payment-methods-table\", 7);\n    i0.ɵɵtemplate(25, RenewhomeComponent_div_5_app_membership_declarations_25_Template, 1, 1, \"app-membership-declarations\", 8);\n    i0.ɵɵtemplate(26, RenewhomeComponent_div_5_button_26_Template, 2, 0, \"button\", 9);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Welcome \", ctx_r1.renewalData.holderName, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r1.renewalData.holderName);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r1.renewalData.contactEmailAddress);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r1.renewalData.currentTarrifDescription);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(20, 10, ctx_r1.renewalData.renewalDate));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.tarrifSelectedId === 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.tarrifSelectedId !== 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.selectedPaymentMethod === 0 && ctx_r1.tarrifSelectedId !== 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.selectedPaymentMethod !== 0 && ctx_r1.tarrifSelectedId !== 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.declarations.termsAccepted);\n  }\n}\n\nfunction RenewhomeComponent_app_please_waitpopup_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-please-waitpopup\");\n  }\n}\n\nexport let RenewhomeComponent = /*#__PURE__*/(() => {\n  class RenewhomeComponent {\n    constructor(tarrifsService, renewalService) {\n      this.tarrifsService = tarrifsService;\n      this.renewalService = renewalService;\n      this.step = 1;\n      this.loading = false;\n      this.selectedPaymentMethod = 0;\n      this.tarrifSelectedId = 0;\n      this.declarations = {\n        termsAccepted: true,\n        additonalDonation: 0,\n        additonalDonationRepeatOnRenewal: false,\n        giftAidDecl: '',\n        cornishman: 0\n      };\n      this.renewalDataDTO = {\n        additionalDonation: 0,\n        giftAidDeclaration: false,\n        securityCode: 0,\n        repeatDonationOnRenewal: false,\n        cornishman: 0,\n        membershipTarrifId: 0,\n        selectPaymentMethod: 0\n      };\n    }\n\n    ngOnInit() {}\n\n    getSelectedTarrifDescription() {\n      return this.tarrifsService.selectedCategory.name + \" - \" + this.tarrifsService.selectedTarrif.description;\n    }\n\n    sendRenewal() {\n      this.renewalDataDTO.additionalDonation = this.declarations.additonalDonation;\n      this.renewalDataDTO.cornishman = this.declarations.cornishman;\n      this.renewalDataDTO.membershipTarrifId = this.tarrifsService.getSelectedTarrifId();\n      this.renewalDataDTO.securityCode = this.renewalData.renewalSecurityCode;\n      this.renewalDataDTO.selectPaymentMethod = this.selectedPaymentMethod;\n      this.renewalDataDTO.giftAidDeclaration = this.declarations.giftAidDecl === 'true' ? true : false;\n      console.log(this.renewalDataDTO);\n      this.loading = true;\n      this.renewalService.completeRenewal(this.renewalDataDTO).subscribe({\n        next: r => {\n          this.loading = false;\n          window.location.href = r.paymentUrl;\n        },\n        error: e => {\n          alert(\"There was an error: \" + e);\n          this.loading = false;\n        }\n      });\n    }\n\n  }\n\n  RenewhomeComponent.ɵfac = function RenewhomeComponent_Factory(t) {\n    return new (t || RenewhomeComponent)(i0.ɵɵdirectiveInject(i1.TarrifService), i0.ɵɵdirectiveInject(i2.RenewService));\n  };\n\n  RenewhomeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: RenewhomeComponent,\n    selectors: [[\"app-renewhome\"]],\n    decls: 7,\n    vars: 4,\n    consts: [[1, \"text-huge\"], [3, \"showLoading\", \"stopLoading\", \"onRenewalStarted\", 4, \"ngIf\"], [4, \"ngIf\"], [3, \"showLoading\", \"stopLoading\", \"onRenewalStarted\"], [1, \"border-bottom\", \"mb-medium\"], [1, \"text-big\"], [3, \"onTarrifSelect\", 4, \"ngIf\"], [3, \"onMethodSelected\", 4, \"ngIf\"], [3, \"declarations\", \"declarationsChange\", 4, \"ngIf\"], [\"class\", \"button button--large\", 3, \"click\", 4, \"ngIf\"], [3, \"onTarrifSelect\"], [1, \"button\", \"button--small\", 3, \"click\"], [3, \"onMethodSelected\"], [3, \"declarations\", \"declarationsChange\"], [1, \"button\", \"button--large\", 3, \"click\"]],\n    template: function RenewhomeComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"h1\", 0);\n        i0.ɵɵtext(1, \"Renew your membership\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(2);\n        i0.ɵɵelement(3, \"hr\");\n        i0.ɵɵtemplate(4, RenewhomeComponent_app_security_lookup_4_Template, 1, 0, \"app-security-lookup\", 1);\n        i0.ɵɵtemplate(5, RenewhomeComponent_div_5_Template, 27, 12, \"div\", 2);\n        i0.ɵɵtemplate(6, RenewhomeComponent_app_please_waitpopup_6_Template, 1, 0, \"app-please-waitpopup\", 2);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\"\\n\", ctx.tarrifSelectedId, \"\\n\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.renewalData == null);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.renewalData != null);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.loading);\n      }\n    },\n    directives: [i3.NgIf, i4.SecurityLookupComponent, i5.TarrifsListComponent, i6.PaymentMethodsTableComponent, i7.MembershipDeclarationsComponent, i8.PleaseWaitpopupComponent],\n    pipes: [i3.DatePipe],\n    styles: [\"\"]\n  });\n  return RenewhomeComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}