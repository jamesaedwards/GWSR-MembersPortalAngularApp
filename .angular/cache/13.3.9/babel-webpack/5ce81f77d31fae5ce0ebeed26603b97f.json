{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../address.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\n\nfunction AddressFormComponent_div_2_div_7_li_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"li\")(1, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function AddressFormComponent_div_2_div_7_li_4_Template_button_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const s_r4 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext(3);\n      return ctx_r5.handleLookupSelect(s_r4.id);\n    });\n    i0.ɵɵtext(2, \"Select\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const s_r4 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", s_r4.address, \" \");\n  }\n}\n\nfunction AddressFormComponent_div_2_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\")(1, \"p\");\n    i0.ɵɵtext(2, \"If you see your address from the suggestions below, please click 'Select' next to it. \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ul\");\n    i0.ɵɵtemplate(4, AddressFormComponent_div_2_div_7_li_4_Template, 4, 1, \"li\", 9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"button\", 10);\n    i0.ɵɵlistener(\"click\", function AddressFormComponent_div_2_div_7_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return ctx_r7.step = 2;\n    });\n    i0.ɵɵtext(6, \"My Address Isn't There\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.lookupSuggestions);\n  }\n}\n\nfunction AddressFormComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 3)(1, \"label\", 4);\n    i0.ɵɵtext(2, \"Please start typing your address in the box below, suggestions will appear below.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 5)(4, \"input\", 6);\n    i0.ɵɵlistener(\"ngModelChange\", function AddressFormComponent_div_2_Template_input_ngModelChange_4_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.lookupSearch = $event;\n    })(\"keyup\", function AddressFormComponent_div_2_Template_input_keyup_4_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return ctx_r11.handleAddressLookup();\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function AddressFormComponent_div_2_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return ctx_r12.step = 2;\n    });\n    i0.ɵɵtext(6, \"enter manually\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, AddressFormComponent_div_2_div_7_Template, 7, 1, \"div\", 8);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.lookupSearch);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.lookupSuggestions !== null && ctx_r0.lookupSuggestions.length > 0);\n  }\n}\n\nfunction AddressFormComponent_form_3_p_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 33);\n    i0.ɵɵtext(1, \"First Line of your address is required\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AddressFormComponent_form_3_p_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 33);\n    i0.ɵɵtext(1, \"Town or City is required\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AddressFormComponent_form_3_p_34_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 33);\n    i0.ɵɵtext(1, \"Postcode is required\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AddressFormComponent_form_3_p_40_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 33);\n    i0.ɵɵtext(1, \"Country is required\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AddressFormComponent_form_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"form\", 11);\n    i0.ɵɵlistener(\"ngSubmit\", function AddressFormComponent_form_3_Template_form_ngSubmit_0_listener() {\n      i0.ɵɵrestoreView(_r18);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return ctx_r17.submit();\n    });\n    i0.ɵɵelementStart(1, \"div\", 12)(2, \"div\", 13)(3, \"label\", 14);\n    i0.ɵɵtext(4, \"Address Line 1: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 15);\n    i0.ɵɵelement(6, \"input\", 16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, AddressFormComponent_form_3_p_7_Template, 2, 0, \"p\", 17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"div\", 18)(9, \"label\", 19);\n    i0.ɵɵtext(10, \"Address Line 2: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"div\", 15);\n    i0.ɵɵelement(12, \"input\", 20);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(13, \"div\", 18)(14, \"label\", 21);\n    i0.ɵɵtext(15, \"Address Line 3: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"div\", 15);\n    i0.ɵɵelement(17, \"input\", 22);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(18, \"div\", 18)(19, \"label\", 23);\n    i0.ɵɵtext(20, \"Town/city: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"div\", 15);\n    i0.ɵɵelement(22, \"input\", 24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(23, AddressFormComponent_form_3_p_23_Template, 2, 0, \"p\", 17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"div\", 18)(25, \"label\", 25);\n    i0.ɵɵtext(26, \"County: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(27, \"div\", 15);\n    i0.ɵɵelement(28, \"input\", 26);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(29, \"div\", 13)(30, \"label\", 27);\n    i0.ɵɵtext(31, \"Postcode: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(32, \"div\", 15);\n    i0.ɵɵelement(33, \"input\", 28);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(34, AddressFormComponent_form_3_p_34_Template, 2, 0, \"p\", 17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(35, \"div\", 29)(36, \"label\", 30);\n    i0.ɵɵtext(37, \"Country: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(38, \"div\", 15);\n    i0.ɵɵelement(39, \"input\", 31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(40, AddressFormComponent_form_3_p_40_Template, 2, 0, \"p\", 17);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(41, \"button\", 32);\n    i0.ɵɵtext(42, \"Next\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r1.addressForm);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"className\", ctx_r1.addressForm.controls[\"addressLine1\"].invalid && ctx_r1.addressForm.controls[\"addressLine1\"].touched ? \"has-error input input-fullWidth\" : \"input input-fullWidth\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.addressForm.controls[\"addressLine1\"].invalid && ctx_r1.addressForm.controls[\"addressLine1\"].touched);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"className\", ctx_r1.addressForm.controls[\"addressLine2\"].invalid && ctx_r1.addressForm.controls[\"addressLine2\"].touched ? \"has-error input input-fullWidth\" : \"input input-fullWidth\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"className\", ctx_r1.addressForm.controls[\"addressLine3\"].invalid && ctx_r1.addressForm.controls[\"addressLine3\"].touched ? \"has-error input input-fullWidth\" : \"input input-fullWidth\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"className\", ctx_r1.addressForm.controls[\"town\"].invalid && ctx_r1.addressForm.controls[\"town\"].touched ? \"has-error input input-fullWidth\" : \"input input-fullWidth\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.addressForm.controls[\"town\"].invalid && ctx_r1.addressForm.controls[\"town\"].touched);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"className\", ctx_r1.addressForm.controls[\"county\"].invalid && ctx_r1.addressForm.controls[\"county\"].touched ? \"has-error input input-fullWidth\" : \"input input-fullWidth\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"className\", ctx_r1.addressForm.controls[\"postCode\"].invalid && ctx_r1.addressForm.controls[\"postCode\"].touched ? \"has-error input input-fullWidth\" : \"input input-fullWidth\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.addressForm.controls[\"postCode\"].invalid && ctx_r1.addressForm.controls[\"postCode\"].touched);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"className\", ctx_r1.addressForm.controls[\"country\"].invalid && ctx_r1.addressForm.controls[\"country\"].touched ? \"has-error input input-fullWidth\" : \"input input-fullWidth\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.addressForm.controls[\"country\"].invalid && ctx_r1.addressForm.controls[\"country\"].touched);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", ctx_r1.addressForm.valid == false);\n  }\n}\n\nexport let AddressFormComponent = /*#__PURE__*/(() => {\n  class AddressFormComponent {\n    constructor(address) {\n      this.address = address;\n      this.addressForm = new FormGroup({\n        addressLine1: new FormControl('', Validators.required),\n        addressLine2: new FormControl(''),\n        addressLine3: new FormControl(''),\n        town: new FormControl('', Validators.required),\n        county: new FormControl(''),\n        postCode: new FormControl('', [Validators.required, Validators.minLength(6), Validators.maxLength(9)]),\n        country: new FormControl('United Kingdom')\n      });\n      this.onFormComplete = new EventEmitter();\n      this.step = 1;\n      this.lookupDone = false;\n      this.lookupSuggestions = [];\n    }\n\n    ngOnInit() {\n      var _a, _b, _c, _d, _e, _f, _g;\n\n      if (this.setAddress) {\n        (_a = this.addressForm.get('addressLine1')) === null || _a === void 0 ? void 0 : _a.setValue(this.setAddress.addressLine1);\n        (_b = this.addressForm.get('addressLine2')) === null || _b === void 0 ? void 0 : _b.setValue(this.setAddress.addressLine2);\n        (_c = this.addressForm.get('addressLine3')) === null || _c === void 0 ? void 0 : _c.setValue(this.setAddress.addressLine3);\n        (_d = this.addressForm.get('town')) === null || _d === void 0 ? void 0 : _d.setValue(this.setAddress.town);\n        (_e = this.addressForm.get('county')) === null || _e === void 0 ? void 0 : _e.setValue(this.setAddress.county);\n        (_f = this.addressForm.get('postCode')) === null || _f === void 0 ? void 0 : _f.setValue(this.setAddress.postCode);\n        (_g = this.addressForm.get('county')) === null || _g === void 0 ? void 0 : _g.setValue(this.setAddress.country);\n        this.step = 2;\n      }\n    }\n\n    handleAddressLookup() {\n      if (this.lookupSearch.length < 5) return;\n      this.address.lookup(this.lookupSearch).subscribe(r => {\n        this.lookupSuggestions = r;\n      });\n    }\n\n    handleLookupSelect(id) {\n      this.address.getAddress(id).subscribe(r => {\n        var _a, _b, _c, _d, _e, _f, _g;\n\n        console.log(r);\n        (_a = this.addressForm.get('addressLine1')) === null || _a === void 0 ? void 0 : _a.setValue(r.addressLine1);\n        (_b = this.addressForm.get('addressLine3')) === null || _b === void 0 ? void 0 : _b.setValue(r.addressLine2);\n        (_c = this.addressForm.get('addressLine3')) === null || _c === void 0 ? void 0 : _c.setValue(r.addressLine3);\n        (_d = this.addressForm.get('town')) === null || _d === void 0 ? void 0 : _d.setValue(r.town);\n        (_e = this.addressForm.get('county')) === null || _e === void 0 ? void 0 : _e.setValue(r.county);\n        (_f = this.addressForm.get('postCode')) === null || _f === void 0 ? void 0 : _f.setValue(r.postCode);\n        (_g = this.addressForm.get('country')) === null || _g === void 0 ? void 0 : _g.setValue(r.country);\n        this.step = this.step + 1;\n      });\n    }\n\n    submit() {\n      var _a, _b, _c, _d, _e, _f, _g;\n\n      if (this.addressForm.valid == false) {\n        alert('Please check the details you have entered. More or more field are invalid.');\n        return;\n      }\n\n      let address = {\n        addressLine1: (_a = this.addressForm.get('addressLine1')) === null || _a === void 0 ? void 0 : _a.value,\n        addressLine2: (_b = this.addressForm.get('addressLine2')) === null || _b === void 0 ? void 0 : _b.value,\n        addressLine3: (_c = this.addressForm.get('addressLine3')) === null || _c === void 0 ? void 0 : _c.value,\n        town: (_d = this.addressForm.get('town')) === null || _d === void 0 ? void 0 : _d.value,\n        county: (_e = this.addressForm.get('county')) === null || _e === void 0 ? void 0 : _e.value,\n        postCode: (_f = this.addressForm.get('postCode')) === null || _f === void 0 ? void 0 : _f.value,\n        country: (_g = this.addressForm.get('country')) === null || _g === void 0 ? void 0 : _g.value,\n        id: ''\n      };\n      this.onFormComplete.emit(address);\n    }\n\n  }\n\n  AddressFormComponent.ɵfac = function AddressFormComponent_Factory(t) {\n    return new (t || AddressFormComponent)(i0.ɵɵdirectiveInject(i1.AddressService));\n  };\n\n  AddressFormComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AddressFormComponent,\n    selectors: [[\"app-address-form\"]],\n    inputs: {\n      personId: \"personId\",\n      setAddress: \"setAddress\"\n    },\n    outputs: {\n      onFormComplete: \"onFormComplete\"\n    },\n    decls: 4,\n    vars: 2,\n    consts: [[1, \"text-big\"], [\"class\", \"\", 4, \"ngIf\"], [3, \"formGroup\", \"ngSubmit\", 4, \"ngIf\"], [1, \"\"], [\"for\", \"search\"], [1, \"input\", \"input-fullWidth\"], [\"id\", \"search\", \"type\", \"text\", 3, \"ngModel\", \"ngModelChange\", \"keyup\"], [1, \"button\", \"button--small\", 3, \"click\"], [4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"], [1, \"button\", 3, \"click\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"row\"], [1, \"col-12\", \"col-lg-4\"], [\"for\", \"addressLine1\"], [3, \"className\"], [\"id\", \"addressLine1\", \"type\", \"text\", \"formControlName\", \"addressLine1\"], [\"class\", \"text-error text-small\", 4, \"ngIf\"], [1, \"col-12\", \"col-md-6\", \"col-lg-4\"], [\"for\", \"addressLine2\"], [\"id\", \"addressLine2\", \"type\", \"text\", \"formControlName\", \"addressLine2\"], [\"for\", \"addressLine4\"], [\"id\", \"addressLine3\", \"type\", \"text\", \"formControlName\", \"addressLine3\"], [\"for\", \"town\"], [\"id\", \"town\", \"type\", \"text\", \"formControlName\", \"town\"], [\"for\", \"county\"], [\"id\", \"county\", \"type\", \"text\", \"formControlName\", \"county\"], [\"for\", \"postcode\"], [\"id\", \"postcode\", \"type\", \"text\", \"formControlName\", \"postCode\"], [1, \"col-12\", \"col-lg-12\"], [\"for\", \"country\"], [\"id\", \"country\", \"type\", \"text\", \"formControlName\", \"country\"], [\"type\", \"submit\", 1, \"button\", 3, \"disabled\"], [1, \"text-error\", \"text-small\"]],\n    template: function AddressFormComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"h2\", 0);\n        i0.ɵɵtext(1, \"Your Address\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(2, AddressFormComponent_div_2_Template, 8, 2, \"div\", 1);\n        i0.ɵɵtemplate(3, AddressFormComponent_form_3_Template, 43, 13, \"form\", 2);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.step === 1);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.step === 2);\n      }\n    },\n    directives: [i2.NgIf, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgModel, i2.NgForOf, i3.ɵNgNoValidate, i3.NgControlStatusGroup, i3.FormGroupDirective, i3.FormControlName],\n    styles: [\"\"]\n  });\n  return AddressFormComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}